name: CI

on:
  push:

jobs:
  setup:
    strategy:
      matrix:
        job: 
          - type: marimo
            action: marimo
          - type: pdoc
            action: pdoc
          - type: test
            action: coverage
          - type: jupyter
            action: jupyter

    runs-on: ubuntu-latest
    steps:
      - name: "Build the virtual environment for ${{ github.repository }}"
        uses: cvxgrp/.github/actions/environment@v2.2.1
      - uses: cvxgrp/.github/actions/{{ matrix.job.action }}@v2.1.2

  book:
    runs-on: ubuntu-latest
    needs: [setup]
    permissions:
      contents: write
    steps:
      - uses: cvxgrp/.github/actions/book@v2.1.2

